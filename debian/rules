#!/usr/bin/make -f
export DH_VERBOSE = 1
export DEB_BUILD_MAINT_OPTIONS = hardening=+all

include /usr/share/dpkg/default.mk  # provides DEB_VERSION

%:
	dh $@

override_dh_auto_clean:
	rm -rf debian/build

override_dh_auto_configure:
	dh_auto_configure --builddirectory=debian/build

override_dh_auto_build:
	cd debian/build && ninja -v

override_dh_auto_test:
ifeq (,$(filter nocheck,$(DEB_BUILD_OPTIONS)))
	cd debian/build && ninja test
endif

override_dh_auto_install:
	cd debian/build && DESTDIR=${CURDIR}/debian/tooth ninja install
	mv debian/tooth/usr/bin/dev.geopjr.tooth debian/tooth/usr/bin/tooth
	sed -i 's/^Exec=.*/Exec=tooth/' debian/tooth/usr/share/applications/dev.geopjr.tooth.desktop


